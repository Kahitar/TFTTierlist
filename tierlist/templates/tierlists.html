{% extends "layout.html" %}
{% block content_fluid %}
    {% set vars = {"found_automatic_tierlist": False} %}
    <h1>Your Tierlists</h1>
    {% if tierlists|length > 0 %}
        <!-- Try to find the automatically generated tierlist -->
        {% for tierlist in tierlists %}
            {% if tierlist.name == "https://cutt.ly/Sologesangs-Tierlist-TFT" %}
                {% if vars.update({"found_automatic_tierlist": True}) %}{% endif %}
            {% endif %}
        {% endfor %}

        <!-- Render the tabs for the tierlists -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            {% for tierlist in tierlists %}
                <li class="nav-item">
                    {% if (tierlist == active_tierlist) or (not active_tierlist and loop.index == 1) %}
                        <a class="nav-link active" id="page-{{ loop.index }}-tab" data-toggle="tab" href="#page-{{ loop.index }}" role="tab"
                            aria-controls="page-{{ loop.index }}" aria-selected="true">{{ tierlist.name }}</a>
                    {% else %}
                        <a class="nav-link" id="page-{{ loop.index }}-tab" data-toggle="tab" href="#page-{{ loop.index }}" role="tab" aria-controls="page-{{ loop.index }}" aria-selected="false">{{ tierlist.name }}</a>
                    {% endif %}
                </li>
            {% endfor %}
            <li class="nav-item">
                <a class="btn btn-outline-info ml-5" id="add-list-tab" href="{{ url_for('tierlists.new_tierlist') }}" role="tab">Add Tierlist</a>
                {% if not vars.found_automatic_tierlist %}
                    <a class="btn btn-outline-info ml-2" href="{{ url_for('comps.update_autogenerated_tierlist') }}">Download Sologesang's Tierlist</a>
                {% endif %}
            </li>
        </ul>

        <!-- Render the tierlists themself -->
        <div class="tab-content">
            {% for tierlist in tierlists %}
                {% if (tierlist == active_tierlist) or (not active_tierlist and loop.index == 1) %}
                    <div class="tab-pane fade show active" id="page-{{ loop.index }}" role="tabpanel"
                        aria-labelledby="page-{{ loop.index }}-tab">
                {% else %}
                    <div class="tab-pane fade" id="page-{{ loop.index }}" role="tabpanel" aria-labelledby="page-{{ loop.index }}-tab">
                {% endif %}

                        {% set comps = all_comps[loop.index-1] %}

                        {% include "tierlist.html" %}
                    </div>

            {% endfor %}
        </div>
    {% else %}
        <h4 class="text-secondary">You have no tierlists.</h4>
        <a class="btn btn-outline-info" id="add-list-tab" href="{{ url_for('tierlists.new_tierlist') }}" role="tab">Add Tierlist</a>
        {% if not vars.found_automatic_tierlist %}
            <a class="btn btn-outline-info ml-2" href="{{ url_for('comps.update_autogenerated_tierlist') }}">Download Sologesang's Tierlist</a>
        {% endif %}
    {% endif %}

{% endblock content_fluid %}
